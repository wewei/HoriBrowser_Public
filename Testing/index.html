<html>
	<head>
	</head>
	<body>
		<h1>It works</h1>
		<input type="text"></input>
		<button onclick="showBaidu()">Baidu</button>
		<button onclick="testGetProperty(10)">test getProperty</button>
		<script type="text/javascript">
        function createWebView(callback)
        {
            var webViewCtrlClass = $H("/Class/WebViewController");
            webViewCtrlClass.call("new", { "arguments" : null }, callback);
        }

        function webViewLoadURL(webViewCtrl, url, callback)
        {
            webViewCtrl.call("loadURL", { "url" : url }, callback);
        }

        function pushViewController(viewCtrl, callback)
        {
            var navCtrl = $H("/User/NavigationController");
            navCtrl.call("pushViewController", { "viewController" : viewCtrl.path }, callback);
        }

		function showBaidu()
		{
            createWebView(function(exception, returnValue) {
                if (exception)
                    alert(JSON.stringify(exception));
                var webViewCtrl = $H(returnValue);
                webViewLoadURL(webViewCtrl, "http://www.baidu.com/", function (exception) {
                    if (exception)
                        alert(JSON.stringify(exception));
                    pushViewController(webViewCtrl, function(exception) {
                        if (exception)
                            alert(JSON.stringify(exception));
                        webViewCtrl.unlink();
                    });
                });
            });
		}

		function testGetProperty(n)
		{
            if (n > 0) {
                $H("/Current/WebViewController").getProperty(
                    "navigationItemTitle",
                    function (exception, returnValue) {
                        document.body.innerHTML += "<p>" + returnValue + "</p>\n";
                        testGetProperty(n - 1);
                    }
                );
            }
		}

		function setRootViewController(path)
		{
			var rootViewController = $H("/System/RootViewController");
			rootViewController.call(
				"presentViewController",
				{
					"viewController": path,
					"animated": 1,
				}
			);
		}

		var navCtrlClass = $H("/Class/NavigationController");
		navCtrlClass.call(
			"new",
			{
				"arguments" : {
					"rootViewController" : "/Current/WebViewController",
				},
			},
			function (exception, returnValue) {
				setRootViewController(returnValue);
                // alert(returnValue);
                $H(returnValue).move("/User/NavigationController");
			}
		);
        $H("/Current/WebViewController").setProperty("navigationItemTitle", "Welcome");

		</script>
	</body>
</html>
